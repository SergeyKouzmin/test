#include "AMQPcpp.h"
#include <iostream>

int main () {

	try {
		std::cout << "Application start" << "\n";

		AMQP amqp;
		std::cout << "Connection parameters: " << std::endl;
		amqp.printConnect();

		AMQPExchange* ex = amqp.createExchange("e");
		ex->Declare("e", "fanout");

		AMQPQueue* qu2 = amqp.createQueue("q2");
		qu2->Declare();
		qu2->Purge();
		qu2->Bind( "e", "");

		string ss = "Hello RabbitMQ";

		ex->setHeader( "type", "text");
		ex->Publish(  ss , "");

		ex->Publish( "message 2 " , "");
		ex->Publish( "message 3 " , "");

		std::cout << "Application stop" << "\n";

	} catch (AMQPException e) {
		std::cout << e.getMessage() << std::endl;
	}

	return 0;
}